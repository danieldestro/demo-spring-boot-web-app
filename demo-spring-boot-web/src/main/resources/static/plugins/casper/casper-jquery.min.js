(function(){var f="localhost"==window.location.hostname&&!0,h=function(){};window.console||(console={});var m=console.log||h;console.trace=f?m||h:h;console.debug=f?m||h:h;console.info=f?m||h:h;console.log=f?m||h:h;console.warn=f?m||h:h;console.error=f?m||h:h})();"function"!==typeof String.prototype.endsWith&&(String.prototype.endsWith=function(f){return-1!==this.indexOf(f,this.length-f.length)});"function"!==typeof String.prototype.startsWith&&(String.prototype.startsWith=function(f){return 0===this.indexOf(prefix)});
console.debug("Casper JQuery Plugin Classes Loading...");
function CasperVoidController(){this.init=function(){};this.onPageLoad=function(){};this.onPageUnload=function(){};this.onSearch=function(){};this.afterSearch=function(){};this.onClear=function(){};this.afterClear=function(){};this.onRefresh=function(){};this.afterRefresh=function(){};this.onPaging=function(f){};this.afterPaging=function(f){};this.onNew=function(){};this.afterNew=function(){};this.onView=function(f){};this.afterView=function(f,h){};this.onEdit=function(f){};this.afterEdit=function(f,
h){};this.onDelete=function(f){};this.afterDelete=function(f){};this.onCancel=function(){};this.afterCancel=function(){};this.onSave=function(){};this.afterSave=function(){}}
function CasperPageStereotypeController(f){var h=this,m={controller:new CasperVoidController,templates:{},actions:{}};h.settings=function(f){return $.extend(!0,m,f)};h.onPageLoad=function(){h.settings().controller.onPageLoad()};h.onPageUnload=function(){h.settings().controller.onPageUnload()};h.init=function(){f.loadTemplates(h.settings().templates,!0);return h};return h}
function CasperCrudStereotypeController(f){function h(g){var a=c.settings(),d="#"+a.containers.list;$.ajax({method:a.apis.list.method,url:a.apis.list.url,data:$("#"+a.forms.search).serialize(),beforeSend:function(){k.spinner(d)}}).done(function(g,a,b){g={data:g};a="#"+c.settings().containers.table;b=c.settings().templates.table;$.Casper.applyTemplate(a,b,g);m(g)}).fail(function(g,a,c){k.errorHandling(g,a,c)}).always(function(a,e,f){a=c.settings().actions;for(var v in a)e=a[v],e.perRecord&&b(e,v);
k.hideSpinner(d);g&&g()})}function m(g){var a="#"+c.settings().containers.pagination;$.Casper.pagination(a,g.data,function(g){c.onPaging(g)})}function q(g,a){var b=c.settings(),d="#"+b.containers.list;$.ajax({method:b.apis["delete"].method,url:b.apis["delete"].url+g,beforeSend:function(){k.spinner(d)}}).done(function(a,b,d){k.banner("warn",{code:0,message:"Record deleted sucessfully"});h();a=c.settings().containers.form;b=c.settings().fields.id.name;$("#"+a+' input[name\x3d"'+b+'"]').val()===g&&$("#"+
a).hide()}).fail(function(a,g,c){k.errorHandling(a,g,c)}).always(function(g,c,b){k.hideSpinner(d);a&&a()})}function e(a,b,e){var g=c.settings(),f="#"+g.containers.form;d(null);$(f).show();$.ajax({method:g.apis.load.method,url:g.apis.load.url+a,beforeSend:function(){k.spinner(f)}}).done(function(a,g,c){d(a,b)}).fail(function(a,g,c){k.errorHandling(a,g,c)}).always(function(g,c,b){k.hideSpinner(f);e&&e(a,g)})}function t(a,c){transForm.deserialize(a,c)}function a(a){var g=c.settings(),b="#"+g.containers.form,
d="#"+g.forms.record,e=c.settings().fields.id.name,f=$(d).find("[name\x3d"+e+"]"),e=null,e=f&&""!=f.val()?"update":"save";$(d).validate({rules:g.validation});$(d).valid()&&(f=$(d).serializeJSON(),$.ajax({method:g.apis[e].method,url:g.apis[e].url,data:f,contentType:"application/json",dataType:"json",beforeSend:function(){k.spinner(b)}}).done(function(a,g,b){k.banner("success",{code:0,message:"Record saved sucessfully"});g="#"+c.settings().fields.id.name;$(d+" "+g).val(a.id);a.hasOwnProperty("lockVersion")&&
(g="#"+c.settings().fields.lockVersion.name,$(d+" "+g).val(a.lockVersion));a.hasOwnProperty("audit")&&a.audit.hasOwnProperty("id")&&(g="#"+c.settings().fields.audit.name,$(d+" "+g).val(a.audit.id));h()}).fail(function(a,g,c){k.errorHandling(a,g,c)}).always(function(g,c,d){k.hideSpinner(b);a&&a()}))}function b(a,c){if(a.id)$("#"+a.id).click(a.click);else if(a.name)$('[name\x3d"'+a.name+'"]').click(a.click);else throw"Action button does not define id or name attributes: "+c;}function d(a,b){a||(a={});
var g=c.settings().forms.record;$("#"+g+" :input").attr("disabled",!1);t("#"+g,a);$("#"+g+" :input").attr("disabled",b?!0:!1);$("#"+c.settings().actions.btnCancel.id).attr("disabled",!1)}function l(a){t(a,{});$(a+" .select2").each(function(){$(this).trigger("change")})}function r(a){try{var g=$(a).validate();$("[name]",a).each(function(){g.successList.push(this);g.showErrors()});g.resetForm();g.reset()}catch(n){}}var c=this,k=f,u={controller:new CasperVoidController,templates:{table:"template-crud-tbl",
form:"template-crud-frm"},containers:{list:"box-page-list",table:"box-page-table",form:"box-page-record",pagination:"box-page-pagination"},forms:{search:"frm-page-search",record:"frm-page-record"},fields:{id:{name:"id",type:"int"},lockVersion:{name:"lockVersion",type:"int"},audit:{name:"audit[id]",type:"int"}},apis:{list:{url:null,method:"GET"},save:{url:null,method:"POST"},update:{url:null,method:"PUT"},"delete":{url:null,method:"DELETE"},load:{url:null,method:"GET"}},actions:{btnSearch:{id:"btn-page-search",
click:function(){c.onSearch()}},btnClear:{id:"btn-page-clear",click:function(){c.onClear()}},btnRefresh:{id:"btn-page-refresh",click:function(){c.onRefresh()}},btnNew:{id:"btn-page-new",click:function(){c.onNew()}},btnView:{name:"btn-page-view",perRecord:!0,click:function(){c.onView($(this).attr("data-id"))}},btnEdit:{name:"btn-page-edit",perRecord:!0,click:function(){c.onEdit($(this).attr("data-id"))}},btnDelete:{name:"btn-page-delete",perRecord:!0,confirm:!0,click:function(){var a=c.settings().actions.btnDelete,
b=$(this).attr("data-id");c.checkConfirmDialog(a,"Do you want to delete the record?",function(){c.onDelete(b)})}},btnCancel:{id:"btn-page-cancel",click:function(){c.onCancel()}},btnSave:{id:"btn-page-save",click:function(){c.onSave()}}},validation:{}};c.checkConfirmDialog=function(a,c,b,d){a.confirm?k.confirm(c,b,d):b&&b()};c.settings=function(a){if(a&&a.apis&&a.apis.restful){var g=c.settings().apis,b;for(b in g)g[b].url=a.apis.restful.url}return $.extend(!0,u,a)};c.onPageLoad=function(){c.settings().controller.onPageLoad();
var a=c.settings().actions,d;for(d in a){var e=a[d];e.perRecord||b(e,d)}h()};c.onPageUnload=function(){c.settings().controller.onPageUnload()};c.onSearch=function(){c.settings().controller.onSearch();var a=c.settings().controller.afterSearch;h(a)};c.onClear=function(){c.settings().controller.onClear();var a=c.settings().forms.search;l("#"+a);a=c.settings().controller.afterClear;h(a)};c.onRefresh=function(){c.settings().controller.onRefresh();var a=c.settings().controller.afterRefresh;h(a)};c.onPaging=
function(a){c.settings().controller.onPaging(a);var b=c.settings().forms.search;$("#"+b+" #frm-page-number").val(a);a=c.settings().controller.afterPaging;h(a)};c.onNew=function(){c.settings().controller.onNew();var a=c.settings().containers.form;r("#"+a);$("#"+a).show(100,function(){d(null)});a=c.settings().controller.afterNew;a()};c.onView=function(a){c.settings().controller.onView(a);var b=c.settings().containers.form;r("#"+b);b=c.settings().controller.afterView;e(a,!0,b)};c.onEdit=function(a){c.settings().controller.onEdit(a);
var b=c.settings().containers.form;r("#"+b);b=c.settings().controller.afterEdit;e(a,!1,b)};c.onDelete=function(a){c.settings().controller.onDelete(a);var b=c.settings().controller.afterDelete;q(a,b)};c.onCancel=function(){c.settings().controller.onCancel();var a=c.settings().containers.form;r("#"+a);$("#"+a).hide();a=c.settings().controller.afterCancel;a()};c.onSave=function(){c.settings().controller.onSave();var b=c.settings().controller.afterSave;a(b)};c.init=function(){k.loadTemplates(c.settings().templates,
!0);var a=c.settings().controller.settings;a&&k.loadTemplates(a().templates,!0);c.settings().controller.init();return c};return c}
(function(f,h){console.debug("Casper JQuery Plugin Loading...");f.Casper=new function(){function m(a,b,d,e,h){b=(d?"disabled ":"")+(b?"active ":"");b=0<b.length?'class\x3d"'+b+'"':"";a=f(a);a.attr("page-num",e);if(h&&!d)a.on("click",function(){var a=f(this).attr("page-num");h(a)});return f("\x3cli "+b+"\x3e\x3c/li\x3e").append(a)}function q(){var a=f('meta[name\x3d"_csrf_header"]').attr("content"),b=f('meta[name\x3d"_csrf"]').attr("content");a?f(document).ajaxSend(function(d,e,f){e.setRequestHeader(a,
b)}):console.warn("CSRF not found on page header")}var e=this,t={context:"",contextParam:"_casper_context",pageType:null,pageController:null,stereotypes:{page:{controller:CasperPageStereotypeController},crud:{controller:CasperCrudStereotypeController}},spinner:{effect:"win8_linear",text:"loading...",bg:"rgba(255,255,255,0.7)",color:"#000"},defaults:{banner:{type:"toaster"}},alert:{container:"#box-alert-message",conf:{method:"html",hideAfter:5E3,fadeOut:500},templates:{error:"alert-error-template",
warn:"alert-warn-template",success:"alert-success-template",info:"alert-info-template"}},toaster:{conf:{stack:5,hideAfter:5E3,allowToastClose:!0,position:"top-right",showHideTransition:"fade"},templates:{error:{loaderBg:"#ff6849",icon:"error",heading:"Error"},warn:{loaderBg:"#ff6849",icon:"warning",heading:"Warning"},success:{loaderBg:"#ff6849",icon:"success",heading:"Success"},info:{loaderBg:"#ff6849",icon:"info",heading:"Info"}}},dialogs:{confirm:{buttons:{confirm:{label:"Yes",className:"btn-success"},
cancel:{label:"No",className:"btn-danger"}}}},pagination:{maxPages:3},htmlElements:{select:{load:"loadDataIntoSelect"}}};e.getWebContext=function(){return e.settings().context};e.settings=function(a){return f.extend(!0,t,a)};e.pagination=function(a,b,d){f(a).empty().off("*");if(b){var l=[],h='\x3ca href\x3d"#"\x3e\x3ci class\x3d"fa fa-angle-double-left"\x3e\x3c/i\x3e\x3c/a\x3e',c='\x3ca href\x3d"#"\x3e\x3ci class\x3d"fa fa-angle-left"\x3e\x3c/i\x3e\x3c/a\x3e',k='\x3ca href\x3d"#"\x3e\x3ci class\x3d"fa fa-angle-right"\x3e\x3c/i\x3e\x3c/a\x3e',
u='\x3ca href\x3d"#"\x3e\x3ci class\x3d"fa fa-angle-double-right"\x3e\x3c/i\x3e\x3c/a\x3e',g=e.settings().pagination.maxPages,t=parseInt(g/2),n=0,q=0,p=0;void 0!==b.number&&(n=b.number);b.totalPages&&(b.totalPages<=g?p=b.totalPages:(p=n-t,q=0>p?0:n+1>=b.totalPages?n-g+1:p,p=q+g,p>=b.totalPages&&(p=b.totalPages)));g=!(void 0===b.first||!1===b.first);h=m(h,!1,g,0,d);g=!(void 0===b.last||!1===b.last);u=m(u,!1,g,b.totalPages-1,d);c=m(c,!1,0>=n,n-1,d);g=!b.totalPages||n+1>=b.totalPages;k=m(k,!1,g,n+1,
d);for(g=q;g<p;g++)b=g==n,l.push(m('\x3ca href\x3d"#"\x3e'+(g+1)+"\x3c/a\x3e",b,!1,g,d));d=[h,c];d=d.concat(l);d=d.concat([k,u]);f(a).append(d)}else f(a).html("\x3cli\x3epagination settings not found\x3c/li\x3e")};e.errorHandling=function(a,b,d){var l="",r=a.status,l=a.responseText;a=!1;switch(r){case 0:l="Not connecting, verify network";break;case 401:a=!0;l="User not authenticated [401]";break;case 403:l="User not authorized to perform this operation [403]";break;case 404:l="Resource not found [404]";
break;case 409:case 412:d=f.parseJSON(l);d.length&&(d=d[0]);l=d.message;l||(l=d.defaultMessage);break;case 500:l="Internal server error [500]";break;default:l="parsererror"===d?"Requested JSON parse failed":"timeout"===d?"Time out error":"abort"===d?"Ajax request aborted":"Uncaught error:\n"+l}a?e.dialog({title:"User not authenticated",message:"You will be redirect to the login page"},function(){h.location.href=e.getWebContext()+"/login"}):f.Casper.banner("error",{code:r,err:b,message:l},{hideAfter:!1})};
e.loadTemplates=function(a,b){for(var d in a)e.loadTemplate(a[d],b)};e.loadTemplate=function(a,b){b&&null===document.getElementById(a)?console.trace("Mustache template not found: "+a):(f.Mustache.addFromDom(a),console.trace("Mustache template found: "+a))};e.alert=function(a,b,d){var l=e.settings().alert.container;a=e.settings().alert.templates[a];var h=b;"string"===typeof b&&(h={message:b});b=f.extend(!0,{},e.settings().alert.conf);d=f.extend(!0,b,d);f(l).mustache(a,h,d);f(l).show();d.hideAfter&&
!1!==d.hideAfter&&f(l).delay(d.hideAfter).fadeOut(d.fadeOut);return e};e.toaster=function(a,b,d,h){var l=f.extend(!0,{},e.settings().toaster.conf);h=f.extend(!0,l,h);"string"!==typeof b&&(b=b.message);a=e.settings().toaster.templates[a];h.showHideTransition=a.showHideTransition;h.loaderBg=a.loaderBg;h.heading=a.heading;h.icon=a.icon;d&&""!==d&&(h.heading=d);h.text=b;f.toast(h)};e.banner=function(a,b,d){"toaster"===e.settings().defaults.banner.type?f.Casper.toaster(a,b,null,d):f.Casper.alert(a,b,d)};
e.applyTemplate=function(a,b,d){f(a).mustache(b,d,{method:"html"})};e.spinner=function(a){f(a).waitMe(e.settings().spinner);return e};e.hideSpinner=function(a){f(a).waitMe("hide");return e};e.dialog=function(a,b){"string"===typeof a?bootbox.alert(a,b):(a.callback=b,bootbox.alert(a));return e};e.confirm=function(a,b,d){var f=e.settings().dialogs.confirm.buttons;bootbox.confirm({message:a,buttons:f,callback:function(a){a?b&&b():d&&d()}});return e};e.loadDataIntoSelect=function(a,b,d){var e=f(a),h=f(a+
" option:selected");a=h?h.index():0;h=h.val();e.html("");d||e.append(new Option);for(var c in b){d=b[c];if("string"===typeof d){var k=0<a&&h==d?!0:!1;d=new Option(d,d,k,k)}else k=0<a&&h==d.value?!0:!1,d=new Option(d.text,d.value,k,k);e.append(d)}e.hasClass("select2")&&e.trigger("change")};e.loadAjaxIntoComponent=function(a,b,d){f.ajax({method:b,url:e.getWebContext()+a}).done(function(a,b,c){b=f(d).get(0).tagName.toLowerCase();c=e.settings().htmlElements[b];if(!c)throw"Element type '"+b+"' not supported";
(0,e[c.load])(d,a)}).fail(function(a,b,c){e.errorHandling(a,b,c)})};e.crud=function(a){return e.page("crud",a)};e.page=function(a,b){if(!a||"string"!==typeof a)throw"stereotype is invalid: "+a;var d=e.settings().stereotypes[a];if(!d)throw"stereotype is not recognized: "+a;console.trace("Configuring page stereotype: "+a);d=new d.controller(e);console.trace("Page controller: "+d.constructor.name);e.settings().pageType=a;e.settings().pageController=d;b&&d.settings(b);return e};e.bind=function(a){if(!a)return e;
"function"===typeof a&&(console.trace("Instanciating new controller: "+a.name),a=new a);if("object"!==typeof a)throw"Controller is not an object";var b=e.settings().pageController;f.extend(!0,b.settings().controller,a);return e};e.init=function(){var a=e.settings().contextParam,b=f('meta[name\x3d"'+a+'"]').attr("content");if(!b||0>=b.length)throw"Web context name was not set in the meta tag ["+a+"]";b.endsWith("/")&&(b=b.substring(0,b.length-1));e.settings().context=b;console.trace("Web context: "+
b);q();e.loadTemplates(e.settings().alert.templates);a=e.settings().pageController;a.init();a.onPageLoad();return e};e.unload=function(){e.settings().pageController.onPageUnload()};return e}})(jQuery,window);(function(f){f(document).ready(function(){});f(window).unload(function(){f.Casper.unload()})})(jQuery);